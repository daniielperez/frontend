/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Handle } from './handle';
/**
 * @record
 */
export function ICornerMarker() { }
if (false) {
    /** @type {?} */
    ICornerMarker.prototype.horizontalNeighbour;
    /** @type {?} */
    ICornerMarker.prototype.verticalNeighbour;
}
var CornerMarker = /** @class */ (function (_super) {
    tslib_1.__extends(CornerMarker, _super);
    function CornerMarker(x, y, radius, cropperSettings) {
        return _super.call(this, x, y, radius, cropperSettings) || this;
    }
    /**
     * @param {?} ctx
     * @return {?}
     */
    CornerMarker.prototype.drawCornerBorder = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        /** @type {?} */
        var sideLength = 10;
        if (this.over || this.drag) {
            sideLength = 12;
        }
        /** @type {?} */
        var hDirection = this.cropperSettings.markerSizeMultiplier;
        /** @type {?} */
        var vDirection = this.cropperSettings.markerSizeMultiplier;
        if (this.horizontalNeighbour.position.x < this.position.x) {
            hDirection = -this.cropperSettings.markerSizeMultiplier;
        }
        if (this.verticalNeighbour.position.y < this.position.y) {
            vDirection = -this.cropperSettings.markerSizeMultiplier;
        }
        ctx.beginPath();
        if (this.cropperSettings.cropperDrawSettings.lineDash) {
            ctx.setLineDash([1, 3]);
        }
        ctx.lineJoin = 'miter';
        ctx.moveTo(this.position.x + this.offset.x, this.position.y + this.offset.y);
        ctx.lineTo(this.position.x + this.offset.x + sideLength * hDirection, this.position.y + this.offset.y);
        ctx.lineTo(this.position.x + this.offset.x + sideLength * hDirection, this.position.y + this.offset.y + sideLength * vDirection);
        ctx.lineTo(this.position.x + this.offset.x, this.position.y + this.offset.y + sideLength * vDirection);
        ctx.lineTo(this.position.x + this.offset.x, this.position.y + this.offset.y);
        ctx.closePath();
        ctx.lineWidth = this.cropperSettings.cropperDrawSettings.strokeWidth;
        ctx.strokeStyle =
            this.cropperSettings.cropperDrawSettings.strokeColor ||
                'rgba(255,255,255,.7)';
        ctx.stroke();
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    CornerMarker.prototype.drawCornerFill = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        /** @type {?} */
        var sideLength = 10;
        if (this.over || this.drag) {
            sideLength = 12;
        }
        /** @type {?} */
        var hDirection = this.cropperSettings.markerSizeMultiplier;
        /** @type {?} */
        var vDirection = this.cropperSettings.markerSizeMultiplier;
        if (this.horizontalNeighbour.position.x < this.position.x) {
            hDirection = -this.cropperSettings.markerSizeMultiplier;
        }
        if (this.verticalNeighbour.position.y < this.position.y) {
            vDirection = -this.cropperSettings.markerSizeMultiplier;
        }
        if (this.cropperSettings.rounded) {
            /** @type {?} */
            var width = this.position.x - this.horizontalNeighbour.position.x;
            /** @type {?} */
            var height = this.position.y - this.verticalNeighbour.position.y;
            /** @type {?} */
            var offX = Math.round(Math.sin(Math.PI / 2) * Math.abs(width / 2)) / 4;
            /** @type {?} */
            var offY = Math.round(Math.sin(Math.PI / 2) * Math.abs(height / 2)) / 4;
            this.offset.x = hDirection > 0 ? offX : -offX;
            this.offset.y = vDirection > 0 ? offY : -offY;
        }
        else {
            this.offset.x = 0;
            this.offset.y = 0;
        }
        ctx.beginPath();
        if (this.cropperSettings.cropperDrawSettings.lineDash) {
            ctx.setLineDash([1, 3]);
        }
        ctx.moveTo(this.position.x + this.offset.x, this.position.y + this.offset.y);
        ctx.lineTo(this.position.x + this.offset.x + sideLength * hDirection, this.position.y + this.offset.y);
        ctx.lineTo(this.position.x + this.offset.x + sideLength * hDirection, this.position.y + this.offset.y + sideLength * vDirection);
        ctx.lineTo(this.position.x + this.offset.x, this.position.y + this.offset.y + sideLength * vDirection);
        ctx.lineTo(this.position.x + this.offset.x, this.position.y + this.offset.y);
        ctx.closePath();
        ctx.fillStyle =
            this.cropperSettings.cropperDrawSettings.fillColor ||
                'rgba(255,255,255,.7)';
        ctx.fill();
    };
    /**
     * @param {?} x
     * @return {?}
     */
    CornerMarker.prototype.moveX = /**
     * @param {?} x
     * @return {?}
     */
    function (x) {
        this.setPosition(x, this.position.y);
    };
    /**
     * @param {?} y
     * @return {?}
     */
    CornerMarker.prototype.moveY = /**
     * @param {?} y
     * @return {?}
     */
    function (y) {
        this.setPosition(this.position.x, y);
    };
    /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    CornerMarker.prototype.move = /**
     * @param {?} x
     * @param {?} y
     * @return {?}
     */
    function (x, y) {
        this.setPosition(x, y);
        this.verticalNeighbour.moveX(x);
        this.horizontalNeighbour.moveY(y);
    };
    /**
     * @param {?} neighbour
     * @return {?}
     */
    CornerMarker.prototype.addHorizontalNeighbour = /**
     * @param {?} neighbour
     * @return {?}
     */
    function (neighbour) {
        this.horizontalNeighbour = neighbour;
    };
    /**
     * @param {?} neighbour
     * @return {?}
     */
    CornerMarker.prototype.addVerticalNeighbour = /**
     * @param {?} neighbour
     * @return {?}
     */
    function (neighbour) {
        this.verticalNeighbour = neighbour;
    };
    /**
     * @return {?}
     */
    CornerMarker.prototype.getHorizontalNeighbour = /**
     * @return {?}
     */
    function () {
        return this.horizontalNeighbour;
    };
    /**
     * @return {?}
     */
    CornerMarker.prototype.getVerticalNeighbour = /**
     * @return {?}
     */
    function () {
        return this.verticalNeighbour;
    };
    /**
     * @param {?} ctx
     * @return {?}
     */
    CornerMarker.prototype.draw = /**
     * @param {?} ctx
     * @return {?}
     */
    function (ctx) {
        this.drawCornerFill(ctx);
        this.drawCornerBorder(ctx);
    };
    return CornerMarker;
}(Handle));
export { CornerMarker };
if (false) {
    /** @type {?} */
    CornerMarker.prototype.horizontalNeighbour;
    /** @type {?} */
    CornerMarker.prototype.verticalNeighbour;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ybmVyTWFya2VyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LWltZy1jcm9wcGVyLyIsInNvdXJjZXMiOlsibGliL2ltYWdlLWNyb3BwZXIvbW9kZWwvY29ybmVyTWFya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLE1BQU0sRUFBVyxNQUFNLFVBQVUsQ0FBQzs7OztBQUczQyxtQ0FHQzs7O0lBRkMsNENBQWtDOztJQUNsQywwQ0FBZ0M7O0FBR2xDO0lBQWtDLHdDQUFNO0lBSXRDLHNCQUNFLENBQVMsRUFDVCxDQUFTLEVBQ1QsTUFBYyxFQUNkLGVBQWdDO2VBRWhDLGtCQUFNLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLGVBQWUsQ0FBQztJQUN0QyxDQUFDOzs7OztJQUVNLHVDQUFnQjs7OztJQUF2QixVQUF3QixHQUE2Qjs7WUFDL0MsVUFBVSxHQUFHLEVBQUU7UUFDbkIsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDMUIsVUFBVSxHQUFHLEVBQUUsQ0FBQztTQUNqQjs7WUFFRyxVQUFVLEdBQVcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxvQkFBb0I7O1lBQzlELFVBQVUsR0FBVyxJQUFJLENBQUMsZUFBZSxDQUFDLG9CQUFvQjtRQUNsRSxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFO1lBQ3pELFVBQVUsR0FBRyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsb0JBQW9CLENBQUM7U0FDekQ7UUFDRCxJQUFJLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFO1lBQ3ZELFVBQVUsR0FBRyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsb0JBQW9CLENBQUM7U0FDekQ7UUFFRCxHQUFHLENBQUMsU0FB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LENBQUMsR0FBRyxDQUFDLENBQUM7UUFDekIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFDSCxtQkFBQztBQUFELENBQUMsQUE5SkQsQ0FBa0MsTUFBTSxHQThKdkM7Ozs7SUE3SkMsMkNBQXlDOztJQUN6Qyx5Q0FBdUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIYW5kbGUsIElIYW5kbGUgfSBmcm9tICcuL2hhbmRsZSc7XHJcbmltcG9ydCB7IENyb3BwZXJTZXR0aW5ncyB9IGZyb20gJy4uL2Nyb3BwZXItc2V0dGluZ3MnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQ29ybmVyTWFya2VyIGV4dGVuZHMgSUhhbmRsZSB7XHJcbiAgaG9yaXpvbnRhbE5laWdoYm91cjogQ29ybmVyTWFya2VyO1xyXG4gIHZlcnRpY2FsTmVpZ2hib3VyOiBDb3JuZXJNYXJrZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb3JuZXJNYXJrZXIgZXh0ZW5kcyBIYW5kbGUgaW1wbGVtZW50cyBJQ29ybmVyTWFya2VyIHtcclxuICBwdWJsaWMgaG9yaXpvbnRhbE5laWdoYm91cjogQ29ybmVyTWFya2VyO1xyXG4gIHB1YmxpYyB2ZXJ0aWNhbE5laWdoYm91cjogQ29ybmVyTWFya2VyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHg6IG51bWJlcixcclxuICAgIHk6IG51bWJlcixcclxuICAgIHJhZGl1czogbnVtYmVyLFxyXG4gICAgY3JvcHBlclNldHRpbmdzOiBDcm9wcGVyU2V0dGluZ3NcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHJhZGl1cywgY3JvcHBlclNldHRpbmdzKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBkcmF3Q29ybmVyQm9yZGVyKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKTogdm9pZCB7XHJcbiAgICBsZXQgc2lkZUxlbmd0aCA9IDEwO1xyXG4gICAgaWYgKHRoaXMub3ZlciB8fCB0aGlzLmRyYWcpIHtcclxuICAgICAgc2lkZUxlbmd0aCA9IDEyO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBoRGlyZWN0aW9uOiBudW1iZXIgPSB0aGlzLmNyb3BwZXJTZXR0aW5ncy5tYXJrZXJTaXplTXVsdGlwbGllcjtcclxuICAgIGxldCB2RGlyZWN0aW9uOiBudW1iZXIgPSB0aGlzLmNyb3BwZXJTZXR0aW5ncy5tYXJrZXJTaXplTXVsdGlwbGllcjtcclxuICAgIGlmICh0aGlzLmhvcml6b250YWxOZWlnaGJvdXIucG9zaXRpb24ueCA8IHRoaXMucG9zaXRpb24ueCkge1xyXG4gICAgICBoRGlyZWN0aW9uID0gLXRoaXMuY3JvcHBlclNldHRpbmdzLm1hcmtlclNpemVNdWx0aXBsaWVyO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudmVydGljYWxOZWlnaGJvdXIucG9zaXRpb24ueSA8IHRoaXMucG9zaXRpb24ueSkge1xyXG4gICAgICB2RGlyZWN0aW9uID0gLXRoaXMuY3JvcHBlclNldHRpbmdzLm1hcmtlclNpemVNdWx0aXBsaWVyO1xyXG4gICAgfVxyXG5cclxuICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgIGlmICh0aGlzLmNyb3BwZXJTZXR0aW5ncy5jcm9wcGVyRHJhd1NldHRpbmdzLmxpbmVEYXNoKSB7XHJcbiAgICAgIGN0eC5zZXRMaW5lRGFzaChbMSwgM10pO1xyXG4gICAgfVxyXG4gICAgY3R4LmxpbmVKb2luID0gJ21pdGVyJztcclxuICAgIGN0eC5tb3ZlVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHgubGluZVRvKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnggKyB0aGlzLm9mZnNldC54ICsgc2lkZUxlbmd0aCAqIGhEaXJlY3Rpb24sXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHgubGluZVRvKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnggKyB0aGlzLm9mZnNldC54ICsgc2lkZUxlbmd0aCAqIGhEaXJlY3Rpb24sXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnkgKyBzaWRlTGVuZ3RoICogdkRpcmVjdGlvblxyXG4gICAgKTtcclxuICAgIGN0eC5saW5lVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnkgKyBzaWRlTGVuZ3RoICogdkRpcmVjdGlvblxyXG4gICAgKTtcclxuICAgIGN0eC5saW5lVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICBjdHgubGluZVdpZHRoID0gdGhpcy5jcm9wcGVyU2V0dGluZ3MuY3JvcHBlckRyYXdTZXR0aW5ncy5zdHJva2VXaWR0aDtcclxuICAgIGN0eC5zdHJva2VTdHlsZSA9XHJcbiAgICAgIHRoaXMuY3JvcHBlclNldHRpbmdzLmNyb3BwZXJEcmF3U2V0dGluZ3Muc3Ryb2tlQ29sb3IgfHxcclxuICAgICAgJ3JnYmEoMjU1LDI1NSwyNTUsLjcpJztcclxuICAgIGN0eC5zdHJva2UoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBkcmF3Q29ybmVyRmlsbChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xyXG4gICAgbGV0IHNpZGVMZW5ndGggPSAxMDtcclxuICAgIGlmICh0aGlzLm92ZXIgfHwgdGhpcy5kcmFnKSB7XHJcbiAgICAgIHNpZGVMZW5ndGggPSAxMjtcclxuICAgIH1cclxuICAgIGxldCBoRGlyZWN0aW9uOiBudW1iZXIgPSB0aGlzLmNyb3BwZXJTZXR0aW5ncy5tYXJrZXJTaXplTXVsdGlwbGllcjtcclxuICAgIGxldCB2RGlyZWN0aW9uOiBudW1iZXIgPSB0aGlzLmNyb3BwZXJTZXR0aW5ncy5tYXJrZXJTaXplTXVsdGlwbGllcjtcclxuICAgIGlmICh0aGlzLmhvcml6b250YWxOZWlnaGJvdXIucG9zaXRpb24ueCA8IHRoaXMucG9zaXRpb24ueCkge1xyXG4gICAgICBoRGlyZWN0aW9uID0gLXRoaXMuY3JvcHBlclNldHRpbmdzLm1hcmtlclNpemVNdWx0aXBsaWVyO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudmVydGljYWxOZWlnaGJvdXIucG9zaXRpb24ueSA8IHRoaXMucG9zaXRpb24ueSkge1xyXG4gICAgICB2RGlyZWN0aW9uID0gLXRoaXMuY3JvcHBlclNldHRpbmdzLm1hcmtlclNpemVNdWx0aXBsaWVyO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmNyb3BwZXJTZXR0aW5ncy5yb3VuZGVkKSB7XHJcbiAgICAgIGNvbnN0IHdpZHRoOiBudW1iZXIgPVxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCAtIHRoaXMuaG9yaXpvbnRhbE5laWdoYm91ci5wb3NpdGlvbi54O1xyXG4gICAgICBjb25zdCBoZWlnaHQ6IG51bWJlciA9XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi55IC0gdGhpcy52ZXJ0aWNhbE5laWdoYm91ci5wb3NpdGlvbi55O1xyXG5cclxuICAgICAgY29uc3Qgb2ZmWDogbnVtYmVyID1cclxuICAgICAgICBNYXRoLnJvdW5kKE1hdGguc2luKE1hdGguUEkgLyAyKSAqIE1hdGguYWJzKHdpZHRoIC8gMikpIC8gNDtcclxuICAgICAgY29uc3Qgb2ZmWTogbnVtYmVyID1cclxuICAgICAgICBNYXRoLnJvdW5kKE1hdGguc2luKE1hdGguUEkgLyAyKSAqIE1hdGguYWJzKGhlaWdodCAvIDIpKSAvIDQ7XHJcblxyXG4gICAgICB0aGlzLm9mZnNldC54ID0gaERpcmVjdGlvbiA+IDAgPyBvZmZYIDogLW9mZlg7XHJcbiAgICAgIHRoaXMub2Zmc2V0LnkgPSB2RGlyZWN0aW9uID4gMCA/IG9mZlkgOiAtb2ZmWTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMub2Zmc2V0LnggPSAwO1xyXG4gICAgICB0aGlzLm9mZnNldC55ID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBjdHguYmVnaW5QYXRoKCk7XHJcbiAgICBpZiAodGhpcy5jcm9wcGVyU2V0dGluZ3MuY3JvcHBlckRyYXdTZXR0aW5ncy5saW5lRGFzaCkge1xyXG4gICAgICBjdHguc2V0TGluZURhc2goWzEsIDNdKTtcclxuICAgIH1cclxuICAgIGN0eC5tb3ZlVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHgubGluZVRvKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnggKyB0aGlzLm9mZnNldC54ICsgc2lkZUxlbmd0aCAqIGhEaXJlY3Rpb24sXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHgubGluZVRvKFxyXG4gICAgICB0aGlzLnBvc2l0aW9uLnggKyB0aGlzLm9mZnNldC54ICsgc2lkZUxlbmd0aCAqIGhEaXJlY3Rpb24sXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnkgKyBzaWRlTGVuZ3RoICogdkRpcmVjdGlvblxyXG4gICAgKTtcclxuICAgIGN0eC5saW5lVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnkgKyBzaWRlTGVuZ3RoICogdkRpcmVjdGlvblxyXG4gICAgKTtcclxuICAgIGN0eC5saW5lVG8oXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0LngsXHJcbiAgICAgIHRoaXMucG9zaXRpb24ueSArIHRoaXMub2Zmc2V0LnlcclxuICAgICk7XHJcbiAgICBjdHguY2xvc2VQYXRoKCk7XHJcbiAgICBjdHguZmlsbFN0eWxlID1cclxuICAgICAgdGhpcy5jcm9wcGVyU2V0dGluZ3MuY3JvcHBlckRyYXdTZXR0aW5ncy5maWxsQ29sb3IgfHxcclxuICAgICAgJ3JnYmEoMjU1LDI1NSwyNTUsLjcpJztcclxuICAgIGN0eC5maWxsKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbW92ZVgoeDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLnNldFBvc2l0aW9uKHgsIHRoaXMucG9zaXRpb24ueSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbW92ZVkoeTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLnNldFBvc2l0aW9uKHRoaXMucG9zaXRpb24ueCwgeSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbW92ZSh4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy5zZXRQb3NpdGlvbih4LCB5KTtcclxuICAgIHRoaXMudmVydGljYWxOZWlnaGJvdXIubW92ZVgoeCk7XHJcbiAgICB0aGlzLmhvcml6b250YWxOZWlnaGJvdXIubW92ZVkoeSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkSG9yaXpvbnRhbE5laWdoYm91cihuZWlnaGJvdXI6IENvcm5lck1hcmtlcik6IHZvaWQge1xyXG4gICAgdGhpcy5ob3Jpem9udGFsTmVpZ2hib3VyID0gbmVpZ2hib3VyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGFkZFZlcnRpY2FsTmVpZ2hib3VyKG5laWdoYm91cjogQ29ybmVyTWFya2VyKTogdm9pZCB7XHJcbiAgICB0aGlzLnZlcnRpY2FsTmVpZ2hib3VyID0gbmVpZ2hib3VyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldEhvcml6b250YWxOZWlnaGJvdXIoKTogQ29ybmVyTWFya2VyIHtcclxuICAgIHJldHVybiB0aGlzLmhvcml6b250YWxOZWlnaGJvdXI7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0VmVydGljYWxOZWlnaGJvdXIoKTogQ29ybmVyTWFya2VyIHtcclxuICAgIHJldHVybiB0aGlzLnZlcnRpY2FsTmVpZ2hib3VyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuICAgIHRoaXMuZHJhd0Nvcm5lckZpbGwoY3R4KTtcclxuICAgIHRoaXMuZHJhd0Nvcm5lckJvcmRlcihjdHgpO1xyXG4gIH1cclxufVxyXG4iXX0=